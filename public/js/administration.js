Administration={init:function(){$("#print").on("click",Administration.printList),$("#new_registration").on("submit",Administration.addRegistration),$("#registrations").on("click",".remove_registration",Administration.removeRegistration),$("#subscribe_anonymous").on("click",Administration.addAnonymousRegistration),$(document).on("click",".edit-handicap",Administration.editHandicap),$(document).on("click",".block-user",Administration.blockUser),$(document).on("click",".release-user",Administration.releaseUser)},printList:function(){var t=parseInt($("#count").html());(0!==t||confirm("De lijst is leeg. Weet je zeker dat je deze wilt afdrukken?"))&&window.print()},addRegistration:function(t){t.preventDefault();var e=this;$.ajax({type:"POST",url:"/administratie/maaltijden/aanmelden",contentType:"application/json",dataType:"html",data:JSON.stringify({meal_id:$(this).attr("data-meal_id"),user_id:$("#user_id").val()}),success:function(t){$("#registrations tbody").append(t),Administration.update_counter(1),e.reset()},error:App.fatalError})},addAnonymousRegistration:function(t){t.preventDefault();var e=prompt("Naam");if(e){var a=prompt("Evt. voedselhandicaps");$.ajax({type:"POST",url:"/administratie/maaltijden/aanmelden",contentType:"application/json",dataType:"html",data:JSON.stringify({meal_id:$(this).attr("data-meal_id"),name:e,handicap:a}),success:function(t){$("#registrations tbody").append(t),Administration.update_counter(1)},error:App.fatalError})}},removeRegistration:function(t){t.preventDefault();var e=$(this).parents(".registration");confirm("Weet je zeker dat je "+$(this).attr("data-name")+" wilt uitschrijven?")&&$.ajax({type:"POST",url:"/administratie/maaltijden/afmelden/"+$(this).attr("data-id"),contentType:"application/json",dataType:"html",success:function(t){e.remove(),Administration.update_counter(-1)},error:App.fatalError})},updateCounter:function(t){var e=$("#count"),a=parseInt(e.html());a+=t,e.html(a)},editHandicap:function(t){t.preventDefault();var e=$(this),a=(e.parents("tr")[0],e.attr("data-id")),i=e.attr("data-handicap");swal({title:"Dieet instellen",text:"Specificeer dieetwensen zo exact en duidelijk mogelijk",type:"input",showCancelButton:!0,closeOnConfirm:!0,inputValue:i},function(t){t!==!1&&i!==t&&$.ajax({type:"POST",url:"/administratie/gebruikers/"+a+"/handicap",contentType:"application/json",data:JSON.stringify({handicap:t}),dataType:"html",success:function(t){$(e.parents("tr")[0]).replaceWith(t)},error:App.fatalError})})},blockUser:function(t){t.preventDefault();var e=$(this);$.ajax({type:"POST",url:"/administratie/gebruikers/"+e.attr("data-id")+"/blokkeren",contentType:"application/json",dataType:"html",success:function(t){$(e.parents("tr")[0]).replaceWith(t)},error:App.fatalError})},releaseUser:function(t){t.preventDefault();var e=$(this);$.ajax({type:"POST",url:"/administratie/gebruikers/"+e.attr("data-id")+"/vrijgeven",contentType:"application/json",success:function(t){$(e.parents("tr")[0]).replaceWith(t)},error:App.fatalError})}},$(document).on("ready",Administration.init);