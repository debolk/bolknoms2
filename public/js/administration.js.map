{"version":3,"sources":["administration.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"administration.js","sourcesContent":["Administration = {\n\n    /**\n     * Start the Adminstration specific log\n     * @return {undefined}\n     */\n    init: function() {\n        // Bind event handlers\n        $('#print').on('click', Administration.printList);\n        $('#new_registration').on('submit', Administration.addRegistration);\n        $('#registrations').on('click', '.remove_registration', Administration.removeRegistration);\n        $('#subscribe_anonymous').on('click', Administration.addAnonymousRegistration);\n    },\n\n    /**\n     * Trigger print dialog for the list of registrations\n     * asking for confirmation if no registrations are present\n     * @return {undefined}\n     */\n    printList: function() {\n        var counter = parseInt($('#count').html());\n        if (counter === 0 && !confirm('De lijst is leeg. Weet je zeker dat je deze wilt afdrukken?')) {\n            return;\n        }\n        window.print();\n    },\n\n    /**\n     * Add a new registration to a meal\n     * @param {Event} event\n     * @return {undefined}\n     */\n    addRegistration: function(event) {\n        event.preventDefault();\n\n        var form = this;\n\n        // Send AJAX-call to register for meal\n        $.ajax({\n            type: 'POST',\n            url: '/administratie/aanmelden',\n            contentType: 'application/json',\n            dataType: 'html',\n            data: JSON.stringify({\n                meal_id:  $(this).attr('data-meal_id'),\n                user_id: $('#user_id').val()\n            }),\n            success: function(response) {\n                $('#registrations tbody').append(response);\n                Administration.update_counter(+1);\n                form.reset();\n            },\n            error: App.fatalError\n        });\n    },\n\n    /**\n     * Add a new anonymous registration to a meal\n     * @param {Event} event\n     * @return {undefined}\n     */\n    addAnonymousRegistration: function(event) {\n\n        event.preventDefault();\n\n        var name = prompt('Naam');\n        if (!name) {\n            return;\n        }\n\n        var handicap = prompt('Evt. voedselhandicaps');\n\n        // Send AJAX-call to register for meal\n        $.ajax({\n            type: 'POST',\n            url: '/administratie/aanmelden',\n            contentType: 'application/json',\n            dataType: 'html',\n            data: JSON.stringify({\n                meal_id:  $(this).attr('data-meal_id'),\n                name:     name,\n                handicap: handicap\n            }),\n            success: function(response) {\n                $('#registrations tbody').append(response);\n                Administration.update_counter(+1);\n            },\n            error: App.fatalError\n        });\n    },\n\n    /**\n     * Remove a registration from a meal\n     * @param  {Event} event\n     * @return {undefined}\n     */\n    removeRegistration: function(event) {\n        event.preventDefault();\n\n        // Ask for confirmation\n        var registration = $(this).parents('.registration');\n        if (! confirm('Weet je zeker dat je '+$(this).attr('data-name')+' wilt uitschrijven?')) {\n            return;\n        }\n\n        // Remove registration\n        $.ajax({\n            type: 'POST',\n            url: '/administratie/afmelden/'+$(this).attr('data-id'),\n            contentType: 'application/json',\n            dataType: 'html',\n            success: function(response) {\n                registration.remove();\n                Administration.update_counter(-1);\n            },\n            error: App.fatalError\n        });\n    },\n\n    /**\n     * Updates the number of registrations in the interface\n     * @param  {int} increment the number to add to the counter, can be negative\n     */\n    updateCounter: function(increment) {\n        var counter = $('#count');\n        var value = parseInt(counter.html());\n        value += increment;\n        counter.html(value);\n    }\n};\n\n$(document).on('ready', Administration.init);\n"],"sourceRoot":"/source/"}